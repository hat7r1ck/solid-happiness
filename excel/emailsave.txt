Private Sub Worksheet_Change(ByVal Target As Range)
    
    ' This code runs AUTOMATICALLY when you change the template dropdown in B2.
    
    Application.EnableEvents = True
    
    If Not Intersect(Target, Me.Range("B2")) Is Nothing Then
        Dim wsFields As Worksheet
        Dim selectedTemplate As String
        Dim lastFieldRow As Long, i As Long, writeRow As Long
        
        Application.EnableEvents = False
        
        On Error GoTo CleanExit
        
        Set wsFields = ThisWorkbook.Sheets("TemplateFields")
        selectedTemplate = Me.Range("B2").Value
        
        ' Clear the old placeholder list
        Me.Range("A6:B100").ClearContents
        
        If selectedTemplate <> "" Then
            lastFieldRow = wsFields.Cells(wsFields.Rows.Count, "A").End(xlUp).Row
            writeRow = 6 ' Starting row for dynamic fields
            
            For i = 2 To lastFieldRow
                If wsFields.Cells(i, "A").Value = selectedTemplate Then
                    Me.Cells(writeRow, "A").Value = wsFields.Cells(i, "B").Value
                    writeRow = writeRow + 1
                End If
            Next i
        End If
    End If

CleanExit:
    Application.EnableEvents = True
End Sub

